{% extends 'base.html' %}
{% block content %}
<div class="row g-4">
    <div class="col-lg-8">
        <div class="card p-4 mb-4">
            <div class="d-flex justify-content-between align-items-center">
                <h3 class="mb-0">This week</h3>
                <a href="{{ url_for('add_entry') }}" class="btn btn-primary">Add Entry</a>
            </div>
            <hr />
            <div class="row text-center">
                <div class="col-6">
                    <div class="metric"><strong>Calories in:</strong> {{ week_in }}</div>
                </div>
                <div class="col-6">
                    <div class="metric"><strong>Calories out:</strong> {{ week_out }}</div>
                </div>
            </div>
        </div>


        <div class="card p-4 mb-4">
            <h4 class="mb-3">Recent entries</h4>
            {% if recent %}
            <div class="table-responsive">
                <table class="table table-dark table-hover align-middle">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>In</th>
                            <th>Out</th>
                            <th>Weight</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for e in recent %}
                        <tr>
                            <td>{{ e.date.strftime('%Y-%m-%d') }}</td>
                            <td>{{ e.calories_in }}</td>
                            <td>{{ e.calories_out }}</td>
                            <td>{% if e.weight_kg %}{{ (e.weight_kg*2.20462)|round(1) }} lb{% endif %}</td>
                            <td>{{ e.notes or '' }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <p class="text-muted mb-0">No entries yet. Add your first one!</p>
            {% endif %}
        </div>
    </div>


    <div class="col-lg-4">
        <div class="card p-4 mb-4">
            <h4 class="mb-3">Targets</h4>
            {% if metrics.target_calories %}
            <p class="mb-1"><strong>Daily target:</strong> {{ metrics.target_calories }} kcal</p>
            <p class="mb-1 text-muted">
                <strong>Basal Metabolic Rate (BMR):</strong> {{ metrics.bmr }} kcal/day
            </p>
            <p class="mb-1 text-muted">
                <strong>Total Daily Energy Expenditure (TDEE):</strong> ~{{ metrics.tdee }} kcal/day
            </p>
            <p class="mb-0 text-muted">
                <strong>Body Mass Index (BMI)</strong> is shown on your Profile page after you add height/weight.
            </p>
            {% else %}
            <p class="text-muted mb-0">Set up your profile to see daily targets.</p>
            {% endif %}
        </div>

        <div class="card p-4">
            <h4 class="mb-3">Exercise ideas</h4>
            {% if recs %}
            <ul class="list-unstyled mb-0">
                {% for r in recs %}
                <li class="mb-3">
                    <div><strong>{{ r.name }}</strong></div>
                    <div class="text-muted small">~{{ r.duration_min }} min · Intensity: {{ r.intensity }} · {{ r.type }}</div>
                    {% if r.note %}<div class="small">{{ r.note }}</div>{% endif %}
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p class="text-muted mb-0">Add your profile to get tailored suggestions.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}